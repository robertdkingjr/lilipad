"""
IC-specific constants to make code and analysis human-readable
"""

# Device addresses
IDT_P9242_ADDR = 0x61  # Power TX
IDT_P9221_ADDR = 0x61  # Power RX
BQ25895_ADDR = 0x6A  # Battery charger
BQ27750_ADDR = 0x55  # Battery fuel gauge + protection

# V2.0 Additions
STUSB5400_ADDR = 0x28  # USB-C controller
I2C_MUX_ADDR = 0x70  # MUX the P9242 + P9221 (both 0x61)


# Key = I2C address
# Value = IC name
I2C_ADDR_MAP = {
    IDT_P9221_ADDR: "P9221",
    IDT_P9242_ADDR: "P9242",
    BQ25895_ADDR: "BQ25895",
    BQ27750_ADDR: "BQ27750",
}


# Key = Reg number
# Value = Default value or None
BQ25895_REG_DEFAULTS = {
    0x00: 0x08,
    0x01: 0x06,
    0x02: 0x3D,
    0x03: 0x3A,
    0x04: 0x20,
    0x05: 0x13,
    0x06: 0x5E,
    0x07: 0x9D,
    0x08: 0x03,
    0x09: 0x44,
    0x0A: 0x93,
    0x0B: None,
    0x0C: None,
    0x0D: 0x12,
    0x0E: 0x00,
    0x0F: 0x00,
    0x10: 0x00,
    0x11: 0x00,
    0x12: 0x00,
    0x13: 0x00,
    0x14: 0x39,
}

# Write 2 bytes, read 1 byte
P9242_REG_DEV_ID_L = [0x01, 0x04]
P9242_REG_DEV_ID_H = [0x01, 0x05]
P9242_REG_FW_MAJOR_L = [0x01, 0x0C]
P9242_REG_FW_MAJOR_H = [0x01, 0x0D]
P9242_REG_FW_MINOR_L = [0x01, 0x0E]
P9242_REG_FW_MINOR_H = [0x01, 0x0F]
P9242_REG_SYSTEM_STATE = [0x06, 0xE0]
P9242_REG_SYSTEM_STATUS = [0x06, 0xE1]
P9242_REG_COIL_CURRENT_L = [0x06, 0xE2]
P9242_REG_COIL_CURRENT_H = [0x06, 0xE3]
P9242_REG_COIL_VOLTAGE_L = [0x06, 0xE4]
P9242_REG_COIL_VOLTAGE_H = [0x06, 0xE5]

P9242_COMMANDS = [
    P9242_REG_DEV_ID_L,
    P9242_REG_DEV_ID_H,
    P9242_REG_FW_MAJOR_L,
    P9242_REG_FW_MAJOR_H,
    P9242_REG_FW_MINOR_L,
    P9242_REG_FW_MINOR_H,
    P9242_REG_SYSTEM_STATE,
    P9242_REG_SYSTEM_STATUS,
    P9242_REG_COIL_CURRENT_L,
    P9242_REG_COIL_CURRENT_H,
    P9242_REG_COIL_VOLTAGE_L,
    P9242_REG_COIL_VOLTAGE_H,
]


# Write 2 bytes, read 1 byte
P9221_REG_PART_NUM_L = [0x00, 0x00]
P9221_REG_PART_NUM_H = [0x00, 0x01]
P9221_REG_FW_MAJOR_L = [0x00, 0x04]
P9221_REG_FW_MAJOR_H = [0x00, 0x05]
P9221_REG_FW_MINOR_L = [0x00, 0x06]
P9221_REG_FW_MINOR_H = [0x00, 0x07]
P9221_REG_STATUS = [0x00, 0x34]
P9221_REG_INT_STATUS = [0x00, 0x36]
P9221_REG_INT_ENABLE = [0x00, 0x38]
P9221_REG_BATT_CHARGE_STATUS = [0x00, 0x3A]
P9221_REG_END_POWER_TRANSFER = [0x00, 0x3B]
P9221_REG_VOUT_L = [0x00, 0x3C]
P9221_REG_VOUT_H = [0x00, 0x3D]
P9221_REG_VRECT_L = [0x00, 0x40]  # in ADC -> V = ADC * 10 * 2.1 / 4095
P9221_REG_VRECT_H = [0x00, 0x41]
P9221_REG_RX_IOUT_L = [0x00, 0x44]  # in mA
P9221_REG_RX_IOUT_H = [0x00, 0x45]
P9221_REG_DIE_TEMP_L = [0x00, 0x46]  # in C
P9221_REG_DIE_TEMP_H = [0x00, 0x47]
P9221_REG_OP_FREQ_L = [0x00, 0x48]  # in kHz
P9221_REG_OP_FREQ_H = [0x00, 0x49]
P9221_REG_ALIGN_X = [0x00, 0x4B]  # 8-bit signed int representing alignment between Tx and Rx coil in the X-direction
P9221_REG_ALIGN_Y = [0x00, 0x4C]  # 8-bit signed int representing alignment between Tx and Rx coil in the Y-direction
P9221_REG_COMMAND = [0x00, 0x4E]

P9221_COMMANDS = [
    P9221_REG_PART_NUM_L,
    P9221_REG_PART_NUM_H,
    P9221_REG_FW_MAJOR_L,
    P9221_REG_FW_MAJOR_H,
    P9221_REG_FW_MINOR_L,
    P9221_REG_FW_MINOR_H,
    P9221_REG_STATUS,
    P9221_REG_INT_STATUS,
    P9221_REG_INT_ENABLE,
    P9221_REG_BATT_CHARGE_STATUS,
    P9221_REG_END_POWER_TRANSFER,
    P9221_REG_VOUT_L,
    P9221_REG_VOUT_H,
    P9221_REG_VRECT_L,
    P9221_REG_VRECT_H,
    P9221_REG_RX_IOUT_L,
    P9221_REG_RX_IOUT_H,
    P9221_REG_DIE_TEMP_L,
    P9221_REG_DIE_TEMP_H,
    P9221_REG_OP_FREQ_L,
    P9221_REG_OP_FREQ_H,
    P9221_REG_ALIGN_X,
    P9221_REG_ALIGN_Y,
    P9221_REG_COMMAND,
]
